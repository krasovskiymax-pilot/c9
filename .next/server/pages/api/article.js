"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/article";
exports.ids = ["pages/api/article"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Farticle&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Carticle.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Farticle&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Carticle.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_article_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\article.ts */ \"(api)/./pages/api/article.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_article_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_article_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/article\",\n        pathname: \"/api/article\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_article_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFydGljbGUmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2FydGljbGUudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDcUQ7QUFDckQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxrREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jOS8/OWM2OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGFydGljbGUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hcnRpY2xlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXJ0aWNsZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Farticle&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Carticle.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/errors.ts":
/*!***********************!*\
  !*** ./lib/errors.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_MESSAGES: () => (/* binding */ ERROR_MESSAGES)\n/* harmony export */ });\n/**\r\n * Дружественные сообщения об ошибках для пользователя.\r\n * Сырые тексты из API не показываются.\r\n */ const ERROR_MESSAGES = {\n    /** Не удалось загрузить статью (404, 500, таймаут, недоступность сайта и т.п.) */ ARTICLE_FETCH_FAILED: \"Не удалось загрузить статью по этой ссылке.\",\n    /** Ошибка AI (OpenRouter, пустой ответ и т.п.) */ AI_PROCESSING_FAILED: \"Не удалось обработать статью. Попробуйте позже.\",\n    /** Не передан URL */ INVALID_URL: \"Пожалуйста, введите URL статьи.\",\n    /** Общая ошибка */ UNKNOWN: \"Произошла ошибка. Попробуйте ещё раз.\"\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZXJyb3JzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FFTSxNQUFNQSxpQkFBaUI7SUFDNUIsZ0ZBQWdGLEdBQ2hGQyxzQkFBc0I7SUFFdEIsZ0RBQWdELEdBQ2hEQyxzQkFBc0I7SUFFdEIsbUJBQW1CLEdBQ25CQyxhQUFhO0lBRWIsaUJBQWlCLEdBQ2pCQyxTQUFTO0FBQ1gsRUFBVyIsInNvdXJjZXMiOlsid2VicGFjazovL2M5Ly4vbGliL2Vycm9ycy50cz8zNmZiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDQlNGA0YPQttC10YHRgtCy0LXQvdC90YvQtSDRgdC+0L7QsdGJ0LXQvdC40Y8g0L7QsSDQvtGI0LjQsdC60LDRhSDQtNC70Y8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPLlxyXG4gKiDQodGL0YDRi9C1INGC0LXQutGB0YLRiyDQuNC3IEFQSSDQvdC1INC/0L7QutCw0LfRi9Cy0LDRjtGC0YHRjy5cclxuICovXHJcblxyXG5leHBvcnQgY29uc3QgRVJST1JfTUVTU0FHRVMgPSB7XHJcbiAgLyoqINCd0LUg0YPQtNCw0LvQvtGB0Ywg0LfQsNCz0YDRg9C30LjRgtGMINGB0YLQsNGC0YzRjiAoNDA0LCA1MDAsINGC0LDQudC80LDRg9GCLCDQvdC10LTQvtGB0YLRg9C/0L3QvtGB0YLRjCDRgdCw0LnRgtCwINC4INGCLtC/LikgKi9cclxuICBBUlRJQ0xFX0ZFVENIX0ZBSUxFRDogXCLQndC1INGD0LTQsNC70L7RgdGMINC30LDQs9GA0YPQt9C40YLRjCDRgdGC0LDRgtGM0Y4g0L/QviDRjdGC0L7QuSDRgdGB0YvQu9C60LUuXCIsXHJcblxyXG4gIC8qKiDQntGI0LjQsdC60LAgQUkgKE9wZW5Sb3V0ZXIsINC/0YPRgdGC0L7QuSDQvtGC0LLQtdGCINC4INGCLtC/LikgKi9cclxuICBBSV9QUk9DRVNTSU5HX0ZBSUxFRDogXCLQndC1INGD0LTQsNC70L7RgdGMINC+0LHRgNCw0LHQvtGC0LDRgtGMINGB0YLQsNGC0YzRji4g0J/QvtC/0YDQvtCx0YPQudGC0LUg0L/QvtC30LbQtS5cIixcclxuXHJcbiAgLyoqINCd0LUg0L/QtdGA0LXQtNCw0L0gVVJMICovXHJcbiAgSU5WQUxJRF9VUkw6IFwi0J/QvtC20LDQu9GD0LnRgdGC0LAsINCy0LLQtdC00LjRgtC1IFVSTCDRgdGC0LDRgtGM0LguXCIsXHJcblxyXG4gIC8qKiDQntCx0YnQsNGPINC+0YjQuNCx0LrQsCAqL1xyXG4gIFVOS05PV046IFwi0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsC4g0J/QvtC/0YDQvtCx0YPQudGC0LUg0LXRidGRINGA0LDQty5cIlxyXG59IGFzIGNvbnN0O1xyXG4iXSwibmFtZXMiOlsiRVJST1JfTUVTU0FHRVMiLCJBUlRJQ0xFX0ZFVENIX0ZBSUxFRCIsIkFJX1BST0NFU1NJTkdfRkFJTEVEIiwiSU5WQUxJRF9VUkwiLCJVTktOT1dOIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/errors.ts\n");

/***/ }),

/***/ "(api)/./lib/fetchArticleText.ts":
/*!*********************************!*\
  !*** ./lib/fetchArticleText.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchArticleText: () => (/* binding */ fetchArticleText)\n/* harmony export */ });\nconst FETCH_TIMEOUT_MS = 30000; // 30 секунд\nconst MAX_TEXT_LENGTH = 15000;\n/**\r\n * Загружает HTML страницы по URL, извлекает текст и возвращает его.\r\n * Этап 1 PLAN.md: парсинг статьи по URL.\r\n */ async function fetchArticleText(url) {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(()=>controller.abort(), FETCH_TIMEOUT_MS);\n    try {\n        const response = await fetch(url, {\n            signal: controller.signal,\n            headers: {\n                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\",\n                Accept: \"text/html,application/xhtml+xml\"\n            }\n        });\n        clearTimeout(timeoutId);\n        if (!response.ok) {\n            throw new Error(`Не удалось загрузить статью (код ${response.status}). Сайт может ограничивать доступ.`);\n        }\n        const html = await response.text();\n        const text = html.replace(/<script[\\s\\S]*?<\\/script>/gi, \"\").replace(/<style[\\s\\S]*?<\\/style>/gi, \"\").replace(/<[^>]+>/g, \" \").replace(/\\s+/g, \" \").trim();\n        if (!text) {\n            throw new Error(\"Не удалось извлечь текст из статьи. Страница может быть пустой или защищена.\");\n        }\n        return text.slice(0, MAX_TEXT_LENGTH);\n    } catch (error) {\n        clearTimeout(timeoutId);\n        if (error instanceof Error) {\n            if (error.name === \"AbortError\") {\n                throw new Error(\"Превышено время ожидания загрузки статьи (30 с). Попробуйте ещё раз.\");\n            }\n            if (error.message.includes(\"fetch failed\") || error.message.includes(\"ECONNREFUSED\") || error.message.includes(\"ENOTFOUND\")) {\n                throw new Error(\"Сайт недоступен. Проверьте URL и подключение к интернету.\");\n            }\n            throw error;\n        }\n        throw new Error(\"Не удалось загрузить статью. Попробуйте другой URL.\");\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvZmV0Y2hBcnRpY2xlVGV4dC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTUEsbUJBQW1CLE9BQVEsWUFBWTtBQUM3QyxNQUFNQyxrQkFBa0I7QUFFeEI7OztDQUdDLEdBQ00sZUFBZUMsaUJBQWlCQyxHQUFXO0lBQ2hELE1BQU1DLGFBQWEsSUFBSUM7SUFDdkIsTUFBTUMsWUFBWUMsV0FBVyxJQUFNSCxXQUFXSSxLQUFLLElBQUlSO0lBRXZELElBQUk7UUFDRixNQUFNUyxXQUFXLE1BQU1DLE1BQU1QLEtBQUs7WUFDaENRLFFBQVFQLFdBQVdPLE1BQU07WUFDekJDLFNBQVM7Z0JBQ1AsY0FDRTtnQkFDRkMsUUFBUTtZQUNWO1FBQ0Y7UUFFQUMsYUFBYVI7UUFFYixJQUFJLENBQUNHLFNBQVNNLEVBQUUsRUFBRTtZQUNoQixNQUFNLElBQUlDLE1BQ1IsQ0FBQyxpQ0FBaUMsRUFBRVAsU0FBU1EsTUFBTSxDQUFDLGtDQUFrQyxDQUFDO1FBRTNGO1FBRUEsTUFBTUMsT0FBTyxNQUFNVCxTQUFTVSxJQUFJO1FBRWhDLE1BQU1BLE9BQU9ELEtBQ1ZFLE9BQU8sQ0FBQywrQkFBK0IsSUFDdkNBLE9BQU8sQ0FBQyw2QkFBNkIsSUFDckNBLE9BQU8sQ0FBQyxZQUFZLEtBQ3BCQSxPQUFPLENBQUMsUUFBUSxLQUNoQkMsSUFBSTtRQUVQLElBQUksQ0FBQ0YsTUFBTTtZQUNULE1BQU0sSUFBSUgsTUFBTTtRQUNsQjtRQUVBLE9BQU9HLEtBQUtHLEtBQUssQ0FBQyxHQUFHckI7SUFDdkIsRUFBRSxPQUFPc0IsT0FBTztRQUNkVCxhQUFhUjtRQUViLElBQUlpQixpQkFBaUJQLE9BQU87WUFDMUIsSUFBSU8sTUFBTUMsSUFBSSxLQUFLLGNBQWM7Z0JBQy9CLE1BQU0sSUFBSVIsTUFBTTtZQUNsQjtZQUNBLElBQUlPLE1BQU1FLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLG1CQUFtQkgsTUFBTUUsT0FBTyxDQUFDQyxRQUFRLENBQUMsbUJBQW1CSCxNQUFNRSxPQUFPLENBQUNDLFFBQVEsQ0FBQyxjQUFjO2dCQUMzSCxNQUFNLElBQUlWLE1BQU07WUFDbEI7WUFDQSxNQUFNTztRQUNSO1FBRUEsTUFBTSxJQUFJUCxNQUFNO0lBQ2xCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jOS8uL2xpYi9mZXRjaEFydGljbGVUZXh0LnRzP2JhZjciXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgRkVUQ0hfVElNRU9VVF9NUyA9IDMwXzAwMDsgLy8gMzAg0YHQtdC60YPQvdC0XHJcbmNvbnN0IE1BWF9URVhUX0xFTkdUSCA9IDE1XzAwMDtcclxuXHJcbi8qKlxyXG4gKiDQl9Cw0LPRgNGD0LbQsNC10YIgSFRNTCDRgdGC0YDQsNC90LjRhtGLINC/0L4gVVJMLCDQuNC30LLQu9C10LrQsNC10YIg0YLQtdC60YHRgiDQuCDQstC+0LfQstGA0LDRidCw0LXRgiDQtdCz0L4uXHJcbiAqINCt0YLQsNC/IDEgUExBTi5tZDog0L/QsNGA0YHQuNC90LMg0YHRgtCw0YLRjNC4INC/0L4gVVJMLlxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQXJ0aWNsZVRleHQodXJsOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XHJcbiAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIEZFVENIX1RJTUVPVVRfTVMpO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcclxuICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIFwiVXNlci1BZ2VudFwiOlxyXG4gICAgICAgICAgXCJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTIwLjAuMC4wIFNhZmFyaS81MzcuMzZcIixcclxuICAgICAgICBBY2NlcHQ6IFwidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbFwiXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIGDQndC1INGD0LTQsNC70L7RgdGMINC30LDQs9GA0YPQt9C40YLRjCDRgdGC0LDRgtGM0Y4gKNC60L7QtCAke3Jlc3BvbnNlLnN0YXR1c30pLiDQodCw0LnRgiDQvNC+0LbQtdGCINC+0LPRgNCw0L3QuNGH0LjQstCw0YLRjCDQtNC+0YHRgtGD0L8uYFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XHJcblxyXG4gICAgY29uc3QgdGV4dCA9IGh0bWxcclxuICAgICAgLnJlcGxhY2UoLzxzY3JpcHRbXFxzXFxTXSo/PFxcL3NjcmlwdD4vZ2ksIFwiXCIpXHJcbiAgICAgIC5yZXBsYWNlKC88c3R5bGVbXFxzXFxTXSo/PFxcL3N0eWxlPi9naSwgXCJcIilcclxuICAgICAgLnJlcGxhY2UoLzxbXj5dKz4vZywgXCIgXCIpXHJcbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKVxyXG4gICAgICAudHJpbSgpO1xyXG5cclxuICAgIGlmICghdGV4dCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCLQndC1INGD0LTQsNC70L7RgdGMINC40LfQstC70LXRh9GMINGC0LXQutGB0YIg0LjQtyDRgdGC0LDRgtGM0LguINCh0YLRgNCw0L3QuNGG0LAg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9GD0YHRgtC+0Lkg0LjQu9C4INC30LDRidC40YnQtdC90LAuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0ZXh0LnNsaWNlKDAsIE1BWF9URVhUX0xFTkdUSCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG5cclxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgIGlmIChlcnJvci5uYW1lID09PSBcIkFib3J0RXJyb3JcIikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcItCf0YDQtdCy0YvRiNC10L3QviDQstGA0LXQvNGPINC+0LbQuNC00LDQvdC40Y8g0LfQsNCz0YDRg9C30LrQuCDRgdGC0LDRgtGM0LggKDMwINGBKS4g0J/QvtC/0YDQvtCx0YPQudGC0LUg0LXRidGRINGA0LDQty5cIik7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJmZXRjaCBmYWlsZWRcIikgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcIkVDT05OUkVGVVNFRFwiKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiRU5PVEZPVU5EXCIpKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi0KHQsNC50YIg0L3QtdC00L7RgdGC0YPQv9C10L0uINCf0YDQvtCy0LXRgNGM0YLQtSBVUkwg0Lgg0L/QvtC00LrQu9GO0YfQtdC90LjQtSDQuiDQuNC90YLQtdGA0L3QtdGC0YMuXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG5cclxuICAgIHRocm93IG5ldyBFcnJvcihcItCd0LUg0YPQtNCw0LvQvtGB0Ywg0LfQsNCz0YDRg9C30LjRgtGMINGB0YLQsNGC0YzRji4g0J/QvtC/0YDQvtCx0YPQudGC0LUg0LTRgNGD0LPQvtC5IFVSTC5cIik7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGRVRDSF9USU1FT1VUX01TIiwiTUFYX1RFWFRfTEVOR1RIIiwiZmV0Y2hBcnRpY2xlVGV4dCIsInVybCIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0SWQiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJyZXNwb25zZSIsImZldGNoIiwic2lnbmFsIiwiaGVhZGVycyIsIkFjY2VwdCIsImNsZWFyVGltZW91dCIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJodG1sIiwidGV4dCIsInJlcGxhY2UiLCJ0cmltIiwic2xpY2UiLCJlcnJvciIsIm5hbWUiLCJtZXNzYWdlIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/fetchArticleText.ts\n");

/***/ }),

/***/ "(api)/./lib/openRouter.ts":
/*!***************************!*\
  !*** ./lib/openRouter.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   callOpenRouter: () => (/* binding */ callOpenRouter)\n/* harmony export */ });\n/* harmony import */ var _prompts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prompts */ \"(api)/./lib/prompts.ts\");\n/**\r\n * Этап 4 PLAN.md: интеграция с OpenRouter.\r\n * 4.1. URL: chat/completions; модель: deepseek/deepseek-chat; ключ из OPENROUTER_API_KEY.\r\n * 4.2. system: контекст; user: текст статьи + инструкция.\r\n * 4.3. Извлечь content из choices[0].message и вернуть.\r\n */ \nconst OPENROUTER_API_KEY = (process.env.OPENROUTER_API_KEY ?? \"\").replace(/^\\[|\\]$/g, \"\");\nconst OPENROUTER_BASE_URL = process.env.OPENAI_BASE_URL ?? \"https://openrouter.ai/api/v1\";\nconst MODEL = \"deepseek/deepseek-chat\";\nconst SYSTEM_CONTEXT = \"Ты помощник, который переводит и пересказывает англоязычные статьи на естественном русском языке.\";\n/**\r\n * Отправляет запрос в OpenRouter (Deepseek) и возвращает сгенерированный текст.\r\n * @param sourceUrl — URL статьи (передаётся для режима telegram, чтобы добавить ссылку на источник).\r\n */ async function callOpenRouter(mode, articleText, sourceUrl) {\n    if (!OPENROUTER_API_KEY.trim()) {\n        throw new Error(\"OPENROUTER_API_KEY не задан в переменных окружения.\");\n    }\n    const instruction = (0,_prompts__WEBPACK_IMPORTED_MODULE_0__.buildInstruction)(mode, sourceUrl);\n    const response = await fetch(`${OPENROUTER_BASE_URL}/chat/completions`, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${OPENROUTER_API_KEY}`\n        },\n        body: JSON.stringify({\n            model: MODEL,\n            messages: [\n                {\n                    role: \"system\",\n                    content: SYSTEM_CONTEXT\n                },\n                {\n                    role: \"user\",\n                    content: [\n                        \"Ниже текст англоязычной статьи.\",\n                        \"\",\n                        articleText,\n                        \"\",\n                        \"Выполни следующее действие:\",\n                        instruction\n                    ].join(\"\\n\")\n                }\n            ]\n        })\n    });\n    if (!response.ok) {\n        const body = await response.text();\n        throw new Error(`Ошибка OpenRouter (${response.status}): ${body || \"нет тела ответа\"}`);\n    }\n    const data = await response.json();\n    const content = data.choices?.[0]?.message?.content;\n    if (!content) {\n        throw new Error(\"Пустой ответ от модели Deepseek.\");\n    }\n    return content.trim();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvb3BlblJvdXRlci50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7OztDQUtDLEdBRzRDO0FBRTdDLE1BQU1DLHFCQUFxQixDQUFDQyxRQUFRQyxHQUFHLENBQUNGLGtCQUFrQixJQUFJLEVBQUMsRUFBR0csT0FBTyxDQUN2RSxZQUNBO0FBRUYsTUFBTUMsc0JBQ0pILFFBQVFDLEdBQUcsQ0FBQ0csZUFBZSxJQUFJO0FBRWpDLE1BQU1DLFFBQVE7QUFFZCxNQUFNQyxpQkFDSjtBQUVGOzs7Q0FHQyxHQUNNLGVBQWVDLGVBQ3BCQyxJQUFVLEVBQ1ZDLFdBQW1CLEVBQ25CQyxTQUFrQjtJQUVsQixJQUFJLENBQUNYLG1CQUFtQlksSUFBSSxJQUFJO1FBQzlCLE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUVBLE1BQU1DLGNBQWNmLDBEQUFnQkEsQ0FBQ1UsTUFBTUU7SUFFM0MsTUFBTUksV0FBVyxNQUFNQyxNQUFNLENBQUMsRUFBRVosb0JBQW9CLGlCQUFpQixDQUFDLEVBQUU7UUFDdEVhLFFBQVE7UUFDUkMsU0FBUztZQUNQLGdCQUFnQjtZQUNoQkMsZUFBZSxDQUFDLE9BQU8sRUFBRW5CLG1CQUFtQixDQUFDO1FBQy9DO1FBQ0FvQixNQUFNQyxLQUFLQyxTQUFTLENBQUM7WUFDbkJDLE9BQU9qQjtZQUNQa0IsVUFBVTtnQkFDUjtvQkFDRUMsTUFBTTtvQkFDTkMsU0FBU25CO2dCQUNYO2dCQUNBO29CQUNFa0IsTUFBTTtvQkFDTkMsU0FBUzt3QkFDUDt3QkFDQTt3QkFDQWhCO3dCQUNBO3dCQUNBO3dCQUNBSTtxQkFDRCxDQUFDYSxJQUFJLENBQUM7Z0JBQ1Q7YUFDRDtRQUNIO0lBQ0Y7SUFFQSxJQUFJLENBQUNaLFNBQVNhLEVBQUUsRUFBRTtRQUNoQixNQUFNUixPQUFPLE1BQU1MLFNBQVNjLElBQUk7UUFDaEMsTUFBTSxJQUFJaEIsTUFDUixDQUFDLG1CQUFtQixFQUFFRSxTQUFTZSxNQUFNLENBQUMsR0FBRyxFQUFFVixRQUFRLGtCQUFrQixDQUFDO0lBRTFFO0lBRUEsTUFBTVcsT0FBUSxNQUFNaEIsU0FBU2lCLElBQUk7SUFJakMsTUFBTU4sVUFBVUssS0FBS0UsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFFQyxTQUFTUjtJQUU1QyxJQUFJLENBQUNBLFNBQVM7UUFDWixNQUFNLElBQUliLE1BQU07SUFDbEI7SUFFQSxPQUFPYSxRQUFRZCxJQUFJO0FBQ3JCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYzkvLi9saWIvb3BlblJvdXRlci50cz80ZmY4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDQrdGC0LDQvyA0IFBMQU4ubWQ6INC40L3RgtC10LPRgNCw0YbQuNGPINGBIE9wZW5Sb3V0ZXIuXHJcbiAqIDQuMS4gVVJMOiBjaGF0L2NvbXBsZXRpb25zOyDQvNC+0LTQtdC70Yw6IGRlZXBzZWVrL2RlZXBzZWVrLWNoYXQ7INC60LvRjtGHINC40LcgT1BFTlJPVVRFUl9BUElfS0VZLlxyXG4gKiA0LjIuIHN5c3RlbTog0LrQvtC90YLQtdC60YHRgjsgdXNlcjog0YLQtdC60YHRgiDRgdGC0LDRgtGM0LggKyDQuNC90YHRgtGA0YPQutGG0LjRjy5cclxuICogNC4zLiDQmNC30LLQu9C10YfRjCBjb250ZW50INC40LcgY2hvaWNlc1swXS5tZXNzYWdlINC4INCy0LXRgNC90YPRgtGMLlxyXG4gKi9cclxuXHJcbmltcG9ydCB0eXBlIHsgTW9kZSB9IGZyb20gXCIuL3Byb21wdHNcIjtcclxuaW1wb3J0IHsgYnVpbGRJbnN0cnVjdGlvbiB9IGZyb20gXCIuL3Byb21wdHNcIjtcclxuXHJcbmNvbnN0IE9QRU5ST1VURVJfQVBJX0tFWSA9IChwcm9jZXNzLmVudi5PUEVOUk9VVEVSX0FQSV9LRVkgPz8gXCJcIikucmVwbGFjZShcclxuICAvXlxcW3xcXF0kL2csXHJcbiAgXCJcIlxyXG4pO1xyXG5jb25zdCBPUEVOUk9VVEVSX0JBU0VfVVJMID1cclxuICBwcm9jZXNzLmVudi5PUEVOQUlfQkFTRV9VUkwgPz8gXCJodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxXCI7XHJcblxyXG5jb25zdCBNT0RFTCA9IFwiZGVlcHNlZWsvZGVlcHNlZWstY2hhdFwiO1xyXG5cclxuY29uc3QgU1lTVEVNX0NPTlRFWFQgPVxyXG4gIFwi0KLRiyDQv9C+0LzQvtGJ0L3QuNC6LCDQutC+0YLQvtGA0YvQuSDQv9C10YDQtdCy0L7QtNC40YIg0Lgg0L/QtdGA0LXRgdC60LDQt9GL0LLQsNC10YIg0LDQvdCz0LvQvtGP0LfRi9GH0L3Ri9C1INGB0YLQsNGC0YzQuCDQvdCwINC10YHRgtC10YHRgtCy0LXQvdC90L7QvCDRgNGD0YHRgdC60L7QvCDRj9C30YvQutC1LlwiO1xyXG5cclxuLyoqXHJcbiAqINCe0YLQv9GA0LDQstC70Y/QtdGCINC30LDQv9GA0L7RgSDQsiBPcGVuUm91dGVyIChEZWVwc2Vlaykg0Lgg0LLQvtC30LLRgNCw0YnQsNC10YIg0YHQs9C10L3QtdGA0LjRgNC+0LLQsNC90L3Ri9C5INGC0LXQutGB0YIuXHJcbiAqIEBwYXJhbSBzb3VyY2VVcmwg4oCUIFVSTCDRgdGC0LDRgtGM0LggKNC/0LXRgNC10LTQsNGR0YLRgdGPINC00LvRjyDRgNC10LbQuNC80LAgdGVsZWdyYW0sINGH0YLQvtCx0Ysg0LTQvtCx0LDQstC40YLRjCDRgdGB0YvQu9C60YMg0L3QsCDQuNGB0YLQvtGH0L3QuNC6KS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxsT3BlblJvdXRlcihcclxuICBtb2RlOiBNb2RlLFxyXG4gIGFydGljbGVUZXh0OiBzdHJpbmcsXHJcbiAgc291cmNlVXJsPzogc3RyaW5nXHJcbik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgaWYgKCFPUEVOUk9VVEVSX0FQSV9LRVkudHJpbSgpKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJPUEVOUk9VVEVSX0FQSV9LRVkg0L3QtSDQt9Cw0LTQsNC9INCyINC/0LXRgNC10LzQtdC90L3Ri9GFINC+0LrRgNGD0LbQtdC90LjRjy5cIik7XHJcbiAgfVxyXG5cclxuICBjb25zdCBpbnN0cnVjdGlvbiA9IGJ1aWxkSW5zdHJ1Y3Rpb24obW9kZSwgc291cmNlVXJsKTtcclxuXHJcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtPUEVOUk9VVEVSX0JBU0VfVVJMfS9jaGF0L2NvbXBsZXRpb25zYCwge1xyXG4gICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtPUEVOUk9VVEVSX0FQSV9LRVl9YFxyXG4gICAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgbW9kZWw6IE1PREVMLFxyXG4gICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBTWVNURU1fQ09OVEVYVFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBbXHJcbiAgICAgICAgICAgIFwi0J3QuNC20LUg0YLQtdC60YHRgiDQsNC90LPQu9C+0Y/Qt9GL0YfQvdC+0Lkg0YHRgtCw0YLRjNC4LlwiLFxyXG4gICAgICAgICAgICBcIlwiLFxyXG4gICAgICAgICAgICBhcnRpY2xlVGV4dCxcclxuICAgICAgICAgICAgXCJcIixcclxuICAgICAgICAgICAgXCLQktGL0L/QvtC70L3QuCDRgdC70LXQtNGD0Y7RidC10LUg0LTQtdC50YHRgtCy0LjQtTpcIixcclxuICAgICAgICAgICAgaW5zdHJ1Y3Rpb25cclxuICAgICAgICAgIF0uam9pbihcIlxcblwiKVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfSlcclxuICB9KTtcclxuXHJcbiAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgYNCe0YjQuNCx0LrQsCBPcGVuUm91dGVyICgke3Jlc3BvbnNlLnN0YXR1c30pOiAke2JvZHkgfHwgXCLQvdC10YIg0YLQtdC70LAg0L7RgtCy0LXRgtCwXCJ9YFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGRhdGEgPSAoYXdhaXQgcmVzcG9uc2UuanNvbigpKSBhcyB7XHJcbiAgICBjaG9pY2VzPzogeyBtZXNzYWdlPzogeyBjb250ZW50Pzogc3RyaW5nIH0gfVtdO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGNvbnRlbnQgPSBkYXRhLmNob2ljZXM/LlswXT8ubWVzc2FnZT8uY29udGVudDtcclxuXHJcbiAgaWYgKCFjb250ZW50KSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCLQn9GD0YHRgtC+0Lkg0L7RgtCy0LXRgiDQvtGCINC80L7QtNC10LvQuCBEZWVwc2Vlay5cIik7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gY29udGVudC50cmltKCk7XHJcbn1cclxuIl0sIm5hbWVzIjpbImJ1aWxkSW5zdHJ1Y3Rpb24iLCJPUEVOUk9VVEVSX0FQSV9LRVkiLCJwcm9jZXNzIiwiZW52IiwicmVwbGFjZSIsIk9QRU5ST1VURVJfQkFTRV9VUkwiLCJPUEVOQUlfQkFTRV9VUkwiLCJNT0RFTCIsIlNZU1RFTV9DT05URVhUIiwiY2FsbE9wZW5Sb3V0ZXIiLCJtb2RlIiwiYXJ0aWNsZVRleHQiLCJzb3VyY2VVcmwiLCJ0cmltIiwiRXJyb3IiLCJpbnN0cnVjdGlvbiIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50Iiwiam9pbiIsIm9rIiwidGV4dCIsInN0YXR1cyIsImRhdGEiLCJqc29uIiwiY2hvaWNlcyIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/openRouter.ts\n");

/***/ }),

/***/ "(api)/./lib/prompts.ts":
/*!************************!*\
  !*** ./lib/prompts.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildInstruction: () => (/* binding */ buildInstruction)\n/* harmony export */ });\n/**\r\n * Этап 3 PLAN.md: промпты для каждой кнопки.\r\n */ /**\r\n * «О чем статья?» — краткое объяснение на русском, 3–6 предложений.\r\n */ const ABOUT_PROMPT = \"Кратко и понятным языком на русском объясни, о чем эта статья. 3–6 предложений.\";\n/**\r\n * «Тезисы» — структурированный список из 5–10 тезисов на русском.\r\n */ const THESIS_PROMPT = \"Сделай структурированный список из 5–10 основных тезисов статьи на русском языке.\";\n/**\r\n * «Пост для Telegram» — готовый пост на русском, 1–3 абзаца, живой стиль, без упоминания ИИ.\r\n * В конце поста добавляется ссылка на источник.\r\n */ const TELEGRAM_PROMPT_BASE = \"Составь готовый пост для Telegram на русском: живой, понятный, 1–3 абзаца, без упоминания, что текст создан ИИ.\";\nconst TELEGRAM_SOURCE_LINK = \" В конце поста добавь ссылку на источник статьи.\";\nfunction buildInstruction(mode, sourceUrl) {\n    switch(mode){\n        case \"about\":\n            return ABOUT_PROMPT;\n        case \"thesis\":\n            return THESIS_PROMPT;\n        case \"telegram\":\n            return TELEGRAM_PROMPT_BASE + TELEGRAM_SOURCE_LINK + (sourceUrl ? ` Укажи ссылку: ${sourceUrl}` : \"\");\n        default:\n            return ABOUT_PROMPT;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHJvbXB0cy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0NBRUMsR0FJRDs7Q0FFQyxHQUNELE1BQU1BLGVBQ0o7QUFFRjs7Q0FFQyxHQUNELE1BQU1DLGdCQUNKO0FBRUY7OztDQUdDLEdBQ0QsTUFBTUMsdUJBQ0o7QUFDRixNQUFNQyx1QkFBdUI7QUFFdEIsU0FBU0MsaUJBQWlCQyxJQUFVLEVBQUVDLFNBQWtCO0lBQzdELE9BQVFEO1FBQ04sS0FBSztZQUNILE9BQU9MO1FBQ1QsS0FBSztZQUNILE9BQU9DO1FBQ1QsS0FBSztZQUNILE9BQ0VDLHVCQUNBQyx1QkFDQ0csQ0FBQUEsWUFBWSxDQUFDLGVBQWUsRUFBRUEsVUFBVSxDQUFDLEdBQUcsRUFBQztRQUVsRDtZQUNFLE9BQU9OO0lBQ1g7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2M5Ly4vbGliL3Byb21wdHMudHM/YzE1NiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog0K3RgtCw0L8gMyBQTEFOLm1kOiDQv9GA0L7QvNC/0YLRiyDQtNC70Y8g0LrQsNC20LTQvtC5INC60L3QvtC/0LrQuC5cclxuICovXHJcblxyXG5leHBvcnQgdHlwZSBNb2RlID0gXCJhYm91dFwiIHwgXCJ0aGVzaXNcIiB8IFwidGVsZWdyYW1cIjtcclxuXHJcbi8qKlxyXG4gKiDCq9CeINGH0LXQvCDRgdGC0LDRgtGM0Y8/wrsg4oCUINC60YDQsNGC0LrQvtC1INC+0LHRitGP0YHQvdC10L3QuNC1INC90LAg0YDRg9GB0YHQutC+0LwsIDPigJM2INC/0YDQtdC00LvQvtC20LXQvdC40LkuXHJcbiAqL1xyXG5jb25zdCBBQk9VVF9QUk9NUFQgPVxyXG4gIFwi0JrRgNCw0YLQutC+INC4INC/0L7QvdGP0YLQvdGL0Lwg0Y/Qt9GL0LrQvtC8INC90LAg0YDRg9GB0YHQutC+0Lwg0L7QsdGK0Y/RgdC90LgsINC+INGH0LXQvCDRjdGC0LAg0YHRgtCw0YLRjNGPLiAz4oCTNiDQv9GA0LXQtNC70L7QttC10L3QuNC5LlwiO1xyXG5cclxuLyoqXHJcbiAqIMKr0KLQtdC30LjRgdGLwrsg4oCUINGB0YLRgNGD0LrRgtGD0YDQuNGA0L7QstCw0L3QvdGL0Lkg0YHQv9C40YHQvtC6INC40LcgNeKAkzEwINGC0LXQt9C40YHQvtCyINC90LAg0YDRg9GB0YHQutC+0LwuXHJcbiAqL1xyXG5jb25zdCBUSEVTSVNfUFJPTVBUID1cclxuICBcItCh0LTQtdC70LDQuSDRgdGC0YDRg9C60YLRg9GA0LjRgNC+0LLQsNC90L3Ri9C5INGB0L/QuNGB0L7QuiDQuNC3IDXigJMxMCDQvtGB0L3QvtCy0L3Ri9GFINGC0LXQt9C40YHQvtCyINGB0YLQsNGC0YzQuCDQvdCwINGA0YPRgdGB0LrQvtC8INGP0LfRi9C60LUuXCI7XHJcblxyXG4vKipcclxuICogwqvQn9C+0YHRgiDQtNC70Y8gVGVsZWdyYW3CuyDigJQg0LPQvtGC0L7QstGL0Lkg0L/QvtGB0YIg0L3QsCDRgNGD0YHRgdC60L7QvCwgMeKAkzMg0LDQsdC30LDRhtCwLCDQttC40LLQvtC5INGB0YLQuNC70YwsINCx0LXQtyDRg9C/0L7QvNC40L3QsNC90LjRjyDQmNCYLlxyXG4gKiDQkiDQutC+0L3RhtC1INC/0L7RgdGC0LAg0LTQvtCx0LDQstC70Y/QtdGC0YHRjyDRgdGB0YvQu9C60LAg0L3QsCDQuNGB0YLQvtGH0L3QuNC6LlxyXG4gKi9cclxuY29uc3QgVEVMRUdSQU1fUFJPTVBUX0JBU0UgPVxyXG4gIFwi0KHQvtGB0YLQsNCy0Ywg0LPQvtGC0L7QstGL0Lkg0L/QvtGB0YIg0LTQu9GPIFRlbGVncmFtINC90LAg0YDRg9GB0YHQutC+0Lw6INC20LjQstC+0LksINC/0L7QvdGP0YLQvdGL0LksIDHigJMzINCw0LHQt9Cw0YbQsCwg0LHQtdC3INGD0L/QvtC80LjQvdCw0L3QuNGPLCDRh9GC0L4g0YLQtdC60YHRgiDRgdC+0LfQtNCw0L0g0JjQmC5cIjtcclxuY29uc3QgVEVMRUdSQU1fU09VUkNFX0xJTksgPSBcIiDQkiDQutC+0L3RhtC1INC/0L7RgdGC0LAg0LTQvtCx0LDQstGMINGB0YHRi9C70LrRgyDQvdCwINC40YHRgtC+0YfQvdC40Log0YHRgtCw0YLRjNC4LlwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkSW5zdHJ1Y3Rpb24obW9kZTogTW9kZSwgc291cmNlVXJsPzogc3RyaW5nKTogc3RyaW5nIHtcclxuICBzd2l0Y2ggKG1vZGUpIHtcclxuICAgIGNhc2UgXCJhYm91dFwiOlxyXG4gICAgICByZXR1cm4gQUJPVVRfUFJPTVBUO1xyXG4gICAgY2FzZSBcInRoZXNpc1wiOlxyXG4gICAgICByZXR1cm4gVEhFU0lTX1BST01QVDtcclxuICAgIGNhc2UgXCJ0ZWxlZ3JhbVwiOlxyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIFRFTEVHUkFNX1BST01QVF9CQVNFICtcclxuICAgICAgICBURUxFR1JBTV9TT1VSQ0VfTElOSyArXHJcbiAgICAgICAgKHNvdXJjZVVybCA/IGAg0KPQutCw0LbQuCDRgdGB0YvQu9C60YM6ICR7c291cmNlVXJsfWAgOiBcIlwiKVxyXG4gICAgICApO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIEFCT1VUX1BST01QVDtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkFCT1VUX1BST01QVCIsIlRIRVNJU19QUk9NUFQiLCJURUxFR1JBTV9QUk9NUFRfQkFTRSIsIlRFTEVHUkFNX1NPVVJDRV9MSU5LIiwiYnVpbGRJbnN0cnVjdGlvbiIsIm1vZGUiLCJzb3VyY2VVcmwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/prompts.ts\n");

/***/ }),

/***/ "(api)/./pages/api/article.ts":
/*!******************************!*\
  !*** ./pages/api/article.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_fetchArticleText__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/fetchArticleText */ \"(api)/./lib/fetchArticleText.ts\");\n/* harmony import */ var _lib_openRouter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/openRouter */ \"(api)/./lib/openRouter.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/errors */ \"(api)/./lib/errors.ts\");\n/**\r\n * POST /api/article\r\n * Этап 2 PLAN.md: API-роут для обработки запросов.\r\n * Принимает: url (адрес статьи), mode (\"about\" | \"thesis\" | \"telegram\").\r\n * Возвращает: { result } или { error }.\r\n * Ошибки возвращаются только в виде дружественных текстов, без сырых сообщений из API.\r\n */ \n\n\nconst VALID_MODES = [\n    \"about\",\n    \"thesis\",\n    \"telegram\"\n];\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ERROR_MESSAGES.UNKNOWN\n        });\n    }\n    const { url, mode } = req.body || {};\n    if (!url || typeof url !== \"string\") {\n        return res.status(400).json({\n            error: _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ERROR_MESSAGES.INVALID_URL\n        });\n    }\n    const currentMode = VALID_MODES.includes(mode) ? mode : \"about\";\n    let articleText;\n    try {\n        articleText = await (0,_lib_fetchArticleText__WEBPACK_IMPORTED_MODULE_0__.fetchArticleText)(url);\n    } catch (error) {\n        console.error(\"[fetchArticleText]\", error);\n        return res.status(400).json({\n            error: _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ERROR_MESSAGES.ARTICLE_FETCH_FAILED\n        });\n    }\n    try {\n        const result = await (0,_lib_openRouter__WEBPACK_IMPORTED_MODULE_1__.callOpenRouter)(currentMode, articleText, url);\n        return res.status(200).json({\n            result\n        });\n    } catch (error) {\n        const errMsg = error instanceof Error ? error.message : String(error);\n        const hasKey = Boolean(process.env.OPENROUTER_API_KEY?.trim());\n        console.error(\"[callOpenRouter]\", errMsg, \"| OPENROUTER_API_KEY:\", hasKey ? \"present\" : \"MISSING\");\n        return res.status(500).json({\n            error: _lib_errors__WEBPACK_IMPORTED_MODULE_2__.ERROR_MESSAGES.AI_PROCESSING_FAILED\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXJ0aWNsZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7OztDQU1DLEdBRTZEO0FBQ1I7QUFFSjtBQUVsRCxNQUFNRyxjQUFzQjtJQUFDO0lBQVM7SUFBVTtDQUFXO0FBRTVDLGVBQWVDLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPUix1REFBY0EsQ0FBQ1MsT0FBTztRQUFDO0lBQzlEO0lBRUEsTUFBTSxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRSxHQUFHUixJQUFJUyxJQUFJLElBQUksQ0FBQztJQUVuQyxJQUFJLENBQUNGLE9BQU8sT0FBT0EsUUFBUSxVQUFVO1FBQ25DLE9BQU9OLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBT1IsdURBQWNBLENBQUNhLFdBQVc7UUFBQztJQUNsRTtJQUVBLE1BQU1DLGNBQW9CYixZQUFZYyxRQUFRLENBQUNKLFFBQVFBLE9BQU87SUFFOUQsSUFBSUs7SUFDSixJQUFJO1FBQ0ZBLGNBQWMsTUFBTWxCLHVFQUFnQkEsQ0FBQ1k7SUFDdkMsRUFBRSxPQUFPRixPQUFPO1FBQ2RTLFFBQVFULEtBQUssQ0FBQyxzQkFBc0JBO1FBQ3BDLE9BQU9KLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBT1IsdURBQWNBLENBQUNrQixvQkFBb0I7UUFBQztJQUMzRTtJQUVBLElBQUk7UUFDRixNQUFNQyxTQUFTLE1BQU1wQiwrREFBY0EsQ0FBQ2UsYUFBYUUsYUFBYU47UUFDOUQsT0FBT04sSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFWTtRQUFPO0lBQ3ZDLEVBQUUsT0FBT1gsT0FBTztRQUNkLE1BQU1ZLFNBQVNaLGlCQUFpQmEsUUFBUWIsTUFBTWMsT0FBTyxHQUFHQyxPQUFPZjtRQUMvRCxNQUFNZ0IsU0FBU0MsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxrQkFBa0IsRUFBRUM7UUFDdkRaLFFBQVFULEtBQUssQ0FDWCxvQkFDQVksUUFDQSx5QkFDQUksU0FBUyxZQUFZO1FBRXZCLE9BQU9wQixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU9SLHVEQUFjQSxDQUFDOEIsb0JBQW9CO1FBQUM7SUFDM0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2M5Ly4vcGFnZXMvYXBpL2FydGljbGUudHM/YTBhNiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUE9TVCAvYXBpL2FydGljbGVcclxuICog0K3RgtCw0L8gMiBQTEFOLm1kOiBBUEkt0YDQvtGD0YIg0LTQu9GPINC+0LHRgNCw0LHQvtGC0LrQuCDQt9Cw0L/RgNC+0YHQvtCyLlxyXG4gKiDQn9GA0LjQvdC40LzQsNC10YI6IHVybCAo0LDQtNGA0LXRgSDRgdGC0LDRgtGM0LgpLCBtb2RlIChcImFib3V0XCIgfCBcInRoZXNpc1wiIHwgXCJ0ZWxlZ3JhbVwiKS5cclxuICog0JLQvtC30LLRgNCw0YnQsNC10YI6IHsgcmVzdWx0IH0g0LjQu9C4IHsgZXJyb3IgfS5cclxuICog0J7RiNC40LHQutC4INCy0L7Qt9Cy0YDQsNGJ0LDRjtGC0YHRjyDRgtC+0LvRjNC60L4g0LIg0LLQuNC00LUg0LTRgNGD0LbQtdGB0YLQstC10L3QvdGL0YUg0YLQtdC60YHRgtC+0LIsINCx0LXQtyDRgdGL0YDRi9GFINGB0L7QvtCx0YnQtdC90LjQuSDQuNC3IEFQSS5cclxuICovXHJcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gXCJuZXh0XCI7XHJcbmltcG9ydCB7IGZldGNoQXJ0aWNsZVRleHQgfSBmcm9tIFwiLi4vLi4vbGliL2ZldGNoQXJ0aWNsZVRleHRcIjtcclxuaW1wb3J0IHsgY2FsbE9wZW5Sb3V0ZXIgfSBmcm9tIFwiLi4vLi4vbGliL29wZW5Sb3V0ZXJcIjtcclxuaW1wb3J0IHsgdHlwZSBNb2RlIH0gZnJvbSBcIi4uLy4uL2xpYi9wcm9tcHRzXCI7XHJcbmltcG9ydCB7IEVSUk9SX01FU1NBR0VTIH0gZnJvbSBcIi4uLy4uL2xpYi9lcnJvcnNcIjtcclxuXHJcbmNvbnN0IFZBTElEX01PREVTOiBNb2RlW10gPSBbXCJhYm91dFwiLCBcInRoZXNpc1wiLCBcInRlbGVncmFtXCJdO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcclxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxyXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlXHJcbikge1xyXG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6IEVSUk9SX01FU1NBR0VTLlVOS05PV04gfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCB7IHVybCwgbW9kZSB9ID0gcmVxLmJvZHkgfHwge307XHJcblxyXG4gIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBFUlJPUl9NRVNTQUdFUy5JTlZBTElEX1VSTCB9KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGN1cnJlbnRNb2RlOiBNb2RlID0gVkFMSURfTU9ERVMuaW5jbHVkZXMobW9kZSkgPyBtb2RlIDogXCJhYm91dFwiO1xyXG5cclxuICBsZXQgYXJ0aWNsZVRleHQ6IHN0cmluZztcclxuICB0cnkge1xyXG4gICAgYXJ0aWNsZVRleHQgPSBhd2FpdCBmZXRjaEFydGljbGVUZXh0KHVybCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJbZmV0Y2hBcnRpY2xlVGV4dF1cIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IEVSUk9SX01FU1NBR0VTLkFSVElDTEVfRkVUQ0hfRkFJTEVEIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGxPcGVuUm91dGVyKGN1cnJlbnRNb2RlLCBhcnRpY2xlVGV4dCwgdXJsKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IHJlc3VsdCB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc3QgZXJyTXNnID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xyXG4gICAgY29uc3QgaGFzS2V5ID0gQm9vbGVhbihwcm9jZXNzLmVudi5PUEVOUk9VVEVSX0FQSV9LRVk/LnRyaW0oKSk7XHJcbiAgICBjb25zb2xlLmVycm9yKFxyXG4gICAgICBcIltjYWxsT3BlblJvdXRlcl1cIixcclxuICAgICAgZXJyTXNnLFxyXG4gICAgICBcInwgT1BFTlJPVVRFUl9BUElfS0VZOlwiLFxyXG4gICAgICBoYXNLZXkgPyBcInByZXNlbnRcIiA6IFwiTUlTU0lOR1wiXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IEVSUk9SX01FU1NBR0VTLkFJX1BST0NFU1NJTkdfRkFJTEVEIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZmV0Y2hBcnRpY2xlVGV4dCIsImNhbGxPcGVuUm91dGVyIiwiRVJST1JfTUVTU0FHRVMiLCJWQUxJRF9NT0RFUyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJVTktOT1dOIiwidXJsIiwibW9kZSIsImJvZHkiLCJJTlZBTElEX1VSTCIsImN1cnJlbnRNb2RlIiwiaW5jbHVkZXMiLCJhcnRpY2xlVGV4dCIsImNvbnNvbGUiLCJBUlRJQ0xFX0ZFVENIX0ZBSUxFRCIsInJlc3VsdCIsImVyck1zZyIsIkVycm9yIiwibWVzc2FnZSIsIlN0cmluZyIsImhhc0tleSIsIkJvb2xlYW4iLCJwcm9jZXNzIiwiZW52IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwidHJpbSIsIkFJX1BST0NFU1NJTkdfRkFJTEVEIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/article.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Farticle&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Carticle.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();