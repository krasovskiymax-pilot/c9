# План добавления функций кнопок

На основании `PROJECT.md`: приложение получает URL англоязычной статьи, парсит её и по нажатию кнопки выполняет соответствующее действие с помощью AI.

---

## 1. Парсинг статьи по URL

1.1. Создать серверную функцию `fetchArticleText(url)`:
- Загрузить HTML страницы по URL (с заголовками `User-Agent`, `Accept`).
- Удалить `<script>` и `<style>`.
- Извлечь текст из HTML (убрать теги, сжать пробелы).
- Ограничить длину (например, 15 000 символов) для запроса к модели.

1.2. Обработать ошибки: код ответа, недоступность сайта, таймаут.

---

## 2. API-роут для обработки запросов

2.1. Создать endpoint `POST /api/article`, принимающий:
- `url` — адрес статьи;
- `mode` — режим: `"about"` | `"thesis"` | `"telegram"`.

2.2. Последовательность в handler:
1. Проверить наличие `url` и `mode`.
2. Вызвать `fetchArticleText(url)`.
3. Сформировать промпт для AI в зависимости от `mode`.
4. Отправить запрос в OpenRouter (Deepseek).
5. Вернуть JSON с полем `result` или `error`.

---

## 3. Промпты для каждой кнопки

3.1. **«О чем статья?»** (`mode: "about"`):
- Инструкция: краткое объяснение на русском, 3–6 предложений.

3.2. **«Тезисы»** (`mode: "thesis"`):
- Инструкция: структурированный список из 5–10 тезисов на русском.

3.3. **«Пост для Telegram»** (`mode: "telegram"`):
- Инструкция: готовый пост на русском, 1–3 абзаца, живой стиль, без упоминания ИИ.

---

## 4. Интеграция с OpenRouter

4.1. Настроить вызов API:
- URL: `https://openrouter.ai/api/v1/chat/completions`;
- Модель: `deepseek/deepseek-chat`;
- API-ключ из `.env.local` (`OPENROUTER_API_KEY`).

4.2. Структура запроса:
- `system`: контекст (помощник по переводу/пересказу статей).
- `user`: текст статьи + инструкция по выбранному режиму.

4.3. Извлечь `content` из `choices[0].message` и вернуть клиенту.

---

## 5. Интерфейс (форма и кнопки)

5.1. Поле ввода URL статьи.

5.2. Три кнопки с `onClick` / `onSubmit`:
- При нажатии вызывать `handleSubmit(selectedMode)`.
- Передавать `mode`: `"about"`, `"thesis"`, `"telegram"`.

5.3. Визуальная подсветка активной кнопки (по `mode`).

5.4. Состояния: `loading`, `error`, `result`.

---

## 6. Блок отображения результата

6.1. Поле «Результат»:
- Показывать `result` из ответа API.
- Во время загрузки: индикатор «Генерация ответа...».
- При ошибке: показывать `error` в отдельном блоке.

6.2. Placeholder, когда ещё нет результата.

---

## Порядок реализации (кратко)

1. Парсинг статьи (`fetchArticleText`).
2. API OpenRouter (модель, промпты, ключ).
3. API-роут `/api/article` (объединить парсинг + AI).
4. Страница: форма, кнопки, блок результата.
5. Связка: `handleSubmit` → `fetch("/api/article")` → отображение `result`.
